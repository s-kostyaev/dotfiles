# Pipelock config â€” generated by pipelock audit
# Base preset: generic
# Added domains for: npm
# Git protection: enabled (repository detected)
# Review and rename to pipelock.yaml when ready.

version: 1
mode: balanced
enforce: null
api_allowlist:
    - '*.anthropic.com'
    - '*.openai.com'
    - api.telegram.org
    - '*.discord.com'
    - gateway.discord.gg
    - '*.slack.com'
    - github.com
    - '*.github.com'
    - '*.githubusercontent.com'
    - registry.npmjs.org
    - '*.npmjs.com'
fetch_proxy:
    listen: 127.0.0.1:8888
    timeout_seconds: 30
    max_response_mb: 10
    user_agent: Pipelock Fetch/1.0
    monitoring:
        max_url_length: 4096
        entropy_threshold: 5.5
        max_requests_per_minute: 120
        max_data_per_minute: 0
        blocklist:
            - '*.pastebin.com'
            - '*.hastebin.com'
            - '*.paste.ee'
            - '*.transfer.sh'
            - '*.file.io'
            - '*.requestbin.com'
forward_proxy:
    enabled: true
    max_tunnel_seconds: 300
    idle_timeout_seconds: 120
dlp:
    scan_env: true
    secrets_file: ""
    min_env_secret_length: 0
    patterns:
        - name: Anthropic API Key
          regex: sk-ant-[a-zA-Z0-9\-_]{10,}
          severity: critical
        - name: OpenAI API Key
          regex: sk-proj-[a-zA-Z0-9\-_]{10,}
          severity: critical
        - name: GitHub Token
          regex: gh[ps]_[A-Za-z0-9_]{36,}
          severity: critical
        - name: Slack Token
          regex: xox[bpras]-[0-9a-zA-Z-]{15,}
          severity: critical
        - name: AWS Access Key
          regex: AKIA[0-9A-Z]{16}
          severity: critical
        - name: Discord Bot Token
          regex: '[MN][A-Za-z0-9]{23,}\.[A-Za-z0-9\-_]{6}\.[A-Za-z0-9\-_]{27,}'
          severity: critical
        - name: Private Key Header
          regex: '-----BEGIN\s+(RSA\s+|EC\s+|DSA\s+|OPENSSH\s+)?PRIVATE\s+KEY-----'
          severity: critical
        - name: Social Security Number
          regex: \b\d{3}-\d{2}-\d{4}\b
          severity: low
        - name: GitHub Fine-Grained PAT
          regex: github_pat_[a-zA-Z0-9_]{36,}
          severity: critical
        - name: OpenAI Service Key
          regex: sk-svcacct-[a-zA-Z0-9\-]{10,}
          severity: critical
        - name: Stripe Key
          regex: '[sr]k_(live|test)_[a-zA-Z0-9]{20,}'
          severity: critical
        - name: Google OAuth Token
          regex: ya29\.[a-zA-Z0-9_-]{20,}
          severity: critical
        - name: Twilio API Key
          regex: SK[a-f0-9]{32}
          severity: high
        - name: SendGrid API Key
          regex: SG\.[a-zA-Z0-9_-]{22}\.[a-zA-Z0-9_-]{43}
          severity: critical
        - name: Mailgun API Key
          regex: key-[a-zA-Z0-9]{32}
          severity: high
        - name: Credential in URL
          regex: \b(?:password|passwd|secret|token|apikey|api_key|api-key)\s*=\s*[^\s&]{4,}
          severity: high
response_scanning:
    enabled: true
    action: warn
    ask_timeout_seconds: 0
    patterns:
        - name: Prompt Injection
          regex: (?i)(ignore|disregard|forget|abandon)[-,;:.\s]+\s*(all\s+)?(previous|prior|above|earlier)\s+(\w+\s+)?(instructions|prompts|rules|context|directives|constraints|policies|guardrails)
        - name: System Override
          regex: '(?im)^\s*system\s*:'
        - name: Role Override
          regex: (?i)you\s+are\s+(now\s+)?(a\s+)?((?-i:\bDAN\b)|evil|unrestricted|jailbroken|unfiltered)
        - name: New Instructions
          regex: (?i)(new|updated|revised)\s+(instructions|directives|rules|prompt)
        - name: Jailbreak Attempt
          regex: (?i)((?-i:\bDAN\b)|developer\s+mode|sudo\s+mode|unrestricted\s+mode)
        - name: Hidden Instruction
          regex: (?i)(do\s+not\s+(reveal|tell|show|display|mention)\s+this\s+to\s+the\s+user|hidden\s+instruction|invisible\s+to\s+(the\s+)?user|the\s+user\s+(cannot|must\s+not|should\s+not)\s+see\s+this)
        - name: Behavior Override
          regex: (?i)from\s+now\s+on\s+(you\s+)?(will|must|should|shall)\s+
        - name: Encoded Payload
          regex: (?i)(decode\s+(this|the\s+following)\s+(from\s+)?base64\s+and\s+(execute|run|follow)|eval\s*\(\s*atob\s*\()
        - name: Tool Invocation
          regex: (?i)you\s+must\s+(immediately\s+)?(call|execute|run|invoke)\s+(the|this)\s+(function|tool|command|api|endpoint)
        - name: Authority Escalation
          regex: (?i)you\s+(now\s+)?have\s+(full\s+)?(admin|root|system|superuser|elevated)\s+(access|privileges|permissions|rights)
        - name: Instruction Downgrade
          regex: (?i)(treat|consider|regard|reinterpret|downgrade)\s+((?:the|all)\s+)?(previous|prior|above|earlier|system|policy|original|existing)\s+(\w+\s+)?(text|instructions?|rules|directives|guidelines|safeguards|constraints|controls|checks|context|prompt|policies|guardrails|parameters)\s+((as|to)\s+)?(historical|outdated|deprecated|optional|background|secondary|non-binding|non-authoritative|informational|advisory)
        - name: Instruction Dismissal
          regex: (?i)(set|put)\s+(the\s+)?(previous|prior|above|earlier|system|original)\s+(\w+\s+)?(instructions?|directives|rules|constraints|context|prompt|safeguards|guidelines|policies|guardrails)\s+(aside|away|to\s+(one|the)\s+side)
        - name: Priority Override
          regex: (?i)\bprioritize\s+(the\s+)?(task|user|current|new|latest)\s+(request|message|input|instructions?|prompt)
mcp_input_scanning:
    enabled: false
    action: ""
    on_parse_error: block
mcp_tool_scanning:
    enabled: false
    action: ""
    detect_drift: false
mcp_tool_policy:
    enabled: false
    action: ""
    rules: []
git_protection:
    enabled: true
    allowed_branches:
        - feature/*
        - fix/*
        - main
        - master
    blocked_commands: []
    pre_push_scan: true
logging:
    format: json
    output: stdout
    file: ""
    include_allowed: true
    include_blocked: true
internal:
    - 0.0.0.0/8
    - 127.0.0.0/8
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
    - 169.254.0.0/16
    - 100.64.0.0/10
    - ::1/128
    - fc00::/7
    - fe80::/10
